
<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>EPA Game v7 Mobile</title>
<style>
body { font-family: sans-serif; margin: 0; background: #ffeef3; }
header { background: pink; padding: 10px; text-align: center; font-weight: bold; font-size: 1.5em; }
.container { padding: 10px; max-width: 600px; margin: auto; }
label { display: block; margin-top: 10px; font-weight: bold; }
input { width: 100%; padding: 8px; margin-top: 5px; }
button { padding: 10px; background: hotpink; border: none; color: white; font-size: 1em; border-radius: 5px; margin-top: 15px; width: 100%; }
.hidden { display: none; }
.question { background: white; padding: 10px; border-radius: 5px; margin-top: 15px; }
.answers button { width: 100%; margin-top: 10px; padding: 10px; font-size: 1em; border-radius: 5px; border: none; }
.teacher { background: #f8cdd1; }
.learner { background: #d3f5d3; }
.over { background: #fde4cf; }
</style>
</head>
<body>
<header>EPA Game v7</header>
<div class="container" id="startScreen">
  <label>教師姓名（必填）</label>
  <input id="teacherName" />
  <label>單位（必填）</label>
  <input id="unitName" />
  <button onclick="startGame()">開始遊戲</button>
</div>

<div class="container hidden" id="gameScreen">
  <div id="instruction" style="background: #fff3cd; padding: 8px; border-radius: 5px;">
    以下對話情境，你覺得是以誰為中心呢？ <a href="#" onclick="alert(spiritTalk);return false;">點我看玩法</a>
  </div>
  <div id="questionBox" class="question"></div>
  <div class="answers">
    <button class="teacher" onclick="answer('teacher')">👩‍🏫 教師中心</button>
    <button class="learner" onclick="answer('learner')">🌱 學員中心（責任分級）</button>
    <button class="over" onclick="answer('over')">💗 過度包容（不健康）</button>
  </div>
</div>

<script>
const GAS_URL = "REPLACE_WITH_YOUR_SCRIPT_URL";
const spiritTalk = `我相信我是一位神隊友老師，學妹一定能接住我傳的球！
凡事發生皆是天助我也～
收好我的白眼，壓住我的深呼吸，讓他相信自己還有救！
不要表露、不要放棄，我們需要新鮮的夥伴一起上班。
想想我的排班、想想我的 OFF Day～
我可以，他也一定可以！`;

const L1 = [
  { id:"L1-01", scene:"交班前。", t:"昨天討論過交班，今天交班前我們先練一次，放輕鬆。", s:"好。", a:"teacher" }
];
let currentQuestionIndex = 0;
let playerName = "";
let playerUnit = "";
let sessionId = Date.now().toString();

function startGame(){
  playerName = document.getElementById("teacherName").value.trim();
  playerUnit = document.getElementById("unitName").value.trim();
  if(!playerName || !playerUnit){ alert("請填寫姓名與單位"); return; }
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("gameScreen").classList.remove("hidden");
  showQuestion();
}

function showQuestion(){
  if(currentQuestionIndex >= L1.length){
    alert("遊戲結束！感謝參加");
    return;
  }
  const q = L1[currentQuestionIndex];
  document.getElementById("questionBox").innerHTML = `<b>${q.scene}</b><br>👩‍🏫 老師：${q.t}<br>🌱 學員：${q.s}`;
}

function answer(choice){
  const q = L1[currentQuestionIndex];
  fetch(GAS_URL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify({
      session_id: sessionId,
      name: playerName,
      unit: playerUnit,
      level: 1,
      item_id: q.id,
      chosen: choice,
      correct: (choice === q.a) ? 1 : 0,
      user_agent: navigator.userAgent
    })
  });
  currentQuestionIndex++;
  showQuestion();
}
</script>
</body>
</html>
